# ğŸ“ Blog API

Uma API REST moderna para gerenciamento de blog construÃ­da com **Node.js**, **Express** e **PostgreSQL**.

---

## ğŸš€ CaracterÃ­sticas

- âœ… CRUD completo de postagens via API REST
- ğŸ˜ IntegraÃ§Ã£o com PostgreSQL
- ğŸ³ ContainerizaÃ§Ã£o com Docker
- ğŸ“š DocumentaÃ§Ã£o automÃ¡tica (Swagger/OpenAPI)
- ğŸ§ª Testes automatizados (Jest)
- ğŸ”„ CI/CD com GitHub Actions
- ğŸ›¡ï¸ Middleware robusto de erros
- ğŸ“Š ValidaÃ§Ã£o de dados

---

## ğŸ› ï¸ Tecnologias

| Camada         | Tecnologia                |
| -------------- | ------------------------ |
| **Backend**    | Node.js, Express.js      |
| **Banco**      | PostgreSQL               |
| **Container**  | Docker, Docker Compose   |
| **Docs**       | Swagger/OpenAPI          |
| **Testes**     | Jest                     |
| **CI/CD**      | GitHub Actions           |

---

## ğŸ“ Estrutura de Arquivos

```text
blog-api/
â”œâ”€â”€ app.js                  # Ponto de entrada
â”œâ”€â”€ package.json            # DependÃªncias e scripts
â”œâ”€â”€ Dockerfile              # Build da imagem Docker
â”œâ”€â”€ docker-compose.yml      # OrquestraÃ§Ã£o dos containers
â”œâ”€â”€ .gitignore              # Ignorados pelo Git
â”œâ”€â”€ .env                    # VariÃ¡veis de ambiente
â”œâ”€â”€ .env.test               # VariÃ¡veis para testes
â”œâ”€â”€ jest.config.js          # ConfiguraÃ§Ã£o do Jest
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml          # Pipeline CI
â”‚
â”œâ”€â”€ config/
â”‚   â””â”€â”€ db.js               # ConexÃ£o PostgreSQL
â”‚
â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ postsController.js  # CRUD das postagens
â”‚
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ error-handling.md   # Docs de erros
â”‚
â”œâ”€â”€ initdb/
â”‚   â””â”€â”€ init.sql            # Script SQL inicial
â”‚
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ errorHandler.js     # Middleware de erros
â”‚
â”œâ”€â”€ models/
â”‚   â””â”€â”€ postModel.js        # Modelo de Postagem
â”‚
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ postsRoutes.js      # Rotas de postagens
â”‚   â””â”€â”€ studentsRoutes.js   # Rotas de estudantes
â”‚   â””â”€â”€ teachersRoutes.js   # Rotas de professores
â”‚
â”œâ”€â”€ swagger/
â”‚   â””â”€â”€ swagger.js          # ConfiguraÃ§Ã£o Swagger
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ config.test.js
    â”œâ”€â”€ postModel.test.js
    â”œâ”€â”€ postsApi.test.js
    â”œâ”€â”€ postsController.test.js
    â”œâ”€â”€ setup.js
    â”œâ”€â”€ teardown.js
    â””â”€â”€ helpers/
        â””â”€â”€ database.js
```

---

## âš¡ InÃ­cio RÃ¡pido

### ğŸ“‹ PrÃ©-requisitos

- Node.js 18+
- Docker & Docker Compose
- Git

### ğŸ”§ InstalaÃ§Ã£o

1. **Clone o repositÃ³rio**
   ```bash
   git clone https://github.com/seu-usuario/blog-api.git
   cd blog-api
   ```

2. **Configure as variÃ¡veis de ambiente**
   - O arquivo `.env` jÃ¡ existe, ajuste conforme necessÃ¡rio.

3. **Execute com Docker** (Recomendado)
   ```bash
   docker-compose up -d
   ```

### ğŸŒ Acesso

- **API:** http://localhost:3000
- **Swagger:** http://localhost:3000/api-docs
- **PostgreSQL:** `localhost:5432`

---

## ğŸ“– Endpoints da API

### ğŸ“ Postagens

| MÃ©todo   | Endpoint             | DescriÃ§Ã£o                |
| -------- | -------------------- | ------------------------ |
| `GET`    | `/api/posts`         | Lista todas as postagens |
| `GET`    | `/api/posts/:id`     | Busca postagem por ID    |
| `POST`   | `/api/posts`         | Cria nova postagem       |
| `PUT`    | `/api/posts/:id`     | Atualiza postagem        |
| `DELETE` | `/api/posts/:id`     | Remove postagem          |

#### ğŸ“‹ Exemplo de Payload

```json
{
  "title": "Minha Primeira Postagem",
  "content": "ConteÃºdo da postagem aqui...",
  "author": "JoÃ£o Silva"
}
```

---

## ğŸ§ª Testes

```bash
# Executar todos os testes
npm test

# Executar testes com coverage
npm run test:coverage

```

#### ğŸ“Š Cobertura

- âœ… ConfiguraÃ§Ã£o
- âœ… Modelo de dados
- âœ… IntegraÃ§Ã£o da API
- âœ… Controladores
- âœ… Helpers de banco

---

## ğŸ³ Docker

### ğŸ—ï¸ Build da imagem

```bash
docker build -t blog-api .
```

### ğŸš€ Executar containers

```bash
docker-compose up -d      # Subir serviÃ§os
docker-compose logs -f api # Ver logs
docker-compose down        # Parar serviÃ§os
```

---

## ğŸ”§ Scripts DisponÃ­veis

```bash
npm start          # ProduÃ§Ã£o
npm run dev        # Desenvolvimento (nodemon)
npm test           # Testes
npm run test:watch # Testes em modo watch
npm run lint       # Lint
npm run lint:fix   # Corrige lint
```

---

## ğŸŒ± VariÃ¡veis de Ambiente

```bash
# Servidor
PORT=3000
NODE_ENV=development

# Banco de Dados
DB_HOST=localhost
DB_PORT=5432
DB_NAME=blog_db
DB_USER=postgres
DB_PASSWORD=postgres

# Swagger
SWAGGER_HOST=localhost:3000
```

---

## ğŸŒ± Desafios enfrentados
Durante o desenvolvimento deste projeto, diversos desafios tÃ©cnicos e operacionais foram enfrentados e superados, contribuindo para o amadurecimento da soluÃ§Ã£o e da equipe. Entre os principais pontos, destacam-se:

- **Tratamento e padronizaÃ§Ã£o de erros:** Inicialmente, as mensagens de erro retornadas pela API eram pouco informativas. Implementamos um middleware robusto para garantir respostas padronizadas e Ãºteis, facilitando o consumo da API por aplicaÃ§Ãµes clientes.
- **ConfiguraÃ§Ã£o de ambiente e integraÃ§Ã£o de serviÃ§os:** A integraÃ§Ã£o entre Swagger, Docker e PostgreSQL exigiu ajustes finos em variÃ¡veis de ambiente, IPs e DNS.
- **Cobertura de testes e integraÃ§Ã£o contÃ­nua:** A configuraÃ§Ã£o do Jest e a integraÃ§Ã£o com o GitHub Actions apresentaram desafios relacionados Ã  cobertura de cÃ³digo e execuÃ§Ã£o dos testes automatizados em ambientes CI/CD, demandando ajustes nos scripts e no pipeline.
- **Deploy em ambiente de produÃ§Ã£o:** O processo de implantaÃ§Ã£o em uma VPS envolveu configuraÃ§Ã£o de chaves SSH, permissÃµes de acesso, setup de proxy reverso com Nginx e implementaÃ§Ã£o de HTTPS via Certbot, garantindo seguranÃ§a e disponibilidade.

Esses desafios foram superados por meio de pesquisa, colaboraÃ§Ã£o entre os membros da equipe e aplicaÃ§Ã£o de boas prÃ¡ticas de desenvolvimento de software.
